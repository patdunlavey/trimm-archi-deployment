{"data":{"type":"metadatadisplay_entity--metadatadisplay_entity","attributes":{"twig":"{# This Template generates Thumbnails for various Media representations \nUpdated on 31\/10\/2023 for 1.3.0 for Cantaloupe 6.x \nStructures passed from Archipelago are \n- node \n  The full Node entity \n- data \n  The Full JSON Structure converted in an Array \n- iiif_server \n  The publicly available IIIF Server (Global Setting) \nSince JSON was decoded into the 'data' values are valid PHP but could not \nbe valid JSON when outputting. So We use data.description|json_encode|raw \nWithout Double quotes. \n#} \n{# <---- SETUP ---> #} \n{# -- The Desired width -- #} \n{% set width = 240 %} \n{# -- The IIIF Server URLS -- #} \n{% set Webserverurl =  url('<front>')|render|replace({':8001\/':''}) ~ ':8183\/iiif\/2\/' %} \n{% set IIIFserverurl = iiif_server ? iiif_server ~ '\/': Webserverurl %} \n{# -- Node Info -- #} \n{% if node.id %} \n  {% set nodeurl = url('entity.node.canonical', {'node': node.id}, {'absolute': true}) %} \n{% else %} \n  {% set nodeurl = '<current>' ~ '\/iiif\/manifest' %} \n{% endif%} \n{# -- Language -- #} \n{% set len = language.getId() ? language.getId() : \"en\" %} \n{# --THIS WILL BE THE IMAGE IIIF URL. CAN HAVE A DEFAULT VALUE IN CASE OF FAILURE THERE IS ALWAYS A GENERIC THUMB-- #} \n{# -- NOTE: for loops are scoped so if we only define source inside one it will not be accesible from the outside- #} \n{% set source = '' %} \n{# <---- END SETUP --> #} \n{#  We will test for 3 main options \n1.- Images \n2.- PDF \n3.- Movies \n#} \n{% apply spaceless %} \n{% if attribute(data, 'as:image')|length > 0 %} \n  {% set document  = data['as:image']|first %} \n  {# if the default size is smaller than the source use the source one #} \n  {% if document['flv:exif'].ImageWidth is defined and document['flv:exif'].ImageWidth < width %} \n     {% set width = document['flv:exif'].ImageWidth %} \n  {% endif %} \n  {% set cantaloupeid  = IIIFserverurl ~ document['url']|replace({'s3:\/\/':''})|replace({'private:\/\/':''})|url_encode %} \n  {% set source = cantaloupeid ~ \"\/full\/\" ~ width  ~ \",\/0\/default.jpg\" %} \n{% elseif attribute(data, 'as:document')|length > 0 %} \n  {% set break = false %} \n  {% for document in data['as:document']%} \n{#- WIZARDLY UPDATED BY ARCHIPELAGO -#} \n{%  if not break %} \n  {# this is just an example, we  allow every PDF here but we can also filter by pronom id \"info:pronom\/fmt\/17\" or info:pronom\/fmt\/18 #} \n    {% if document['flv:exif'].MIMEType == \"application\/pdf\" and document['flv:exif'].PageCount > 0 %} \n      {% set cantaloupeid  = IIIFserverurl ~ document['url']|replace({'s3:\/\/':''})|replace({'private:\/\/':''})|url_encode %} \n      {% set source = cantaloupeid ~ \";1\" ~\"\/full\/\" ~ width  ~ \",\/0\/default.jpg\" %} \n      {% set break = true %} \n    {% endif%} \n  {#- WIZARDLY UPDATED BY ARCHIPELAGO -#} \n{% endif %} \n{% endfor %} \n{% elseif attribute(data, 'as:video')|length > 0 %} \n  {% set break = false %} \n  {% for document in data['as:video']%} \n{#- WIZARDLY UPDATED BY ARCHIPELAGO -#} \n{%  if not break %} \n  {# this is just an example, we process here only MP4 quicktimes #} \n    {% if document['flv:pronom'].mimetype == \"video\/quicktime\" %} \n      {% set cantaloupeid  = IIIFserverurl ~ document['url']|replace({'s3:\/\/':''})|replace({'private:\/\/':''})|url_encode %} \n      {% set source = cantaloupeid ~ \";1\/full\/\" ~ width  ~ \",\/0\/default.jpg\" %} \n      {% set break = true %} \n    {% endif %} \n  {#- WIZARDLY UPDATED BY ARCHIPELAGO -#} \n{% endif %} \n{% endfor %} \n{% endif%} \n{# <----START OUTPUT --> #} \n<a href=\"{{ nodeurl }}\" alt=\"{{ node.label.value }}\" hreflang=\"{{ len }}\"> \n{% if source|length > 0 %} \n{# NOTE: remote iiif-lazy class if you do not want lazy loading #} \n<img class=\"field-iiif image-iiif iiif-lazy img-fluid rounded\" id=\"thumb_iiif-field_descriptive_metadata-{{ node.uuid.value }}-0-image1\" src=\"{{ source }}\" width=\"240\" alt=\"Thumbnail for {{ node.label.value }}\" typeof=\"foaf:Image\"> \n{% else %} \n{# -- IF we have no source we can e.g use font awesome -- #} \n{# \nOptions we took from \/admin\/structure\/webform\/config\/options\/manage\/schema_org_creative_works\/source \nArticle: Article \nBook: Book \nCollection: Collection \nDataset: Dataset \nDigitalDocument: 'Digital Document' \nMap: Map \nMovie: Movie \nMusicRecording: 'Music Recording' \nPainting: Painting \nPhotograph: Photograph \nSculpture: Sculpture \nVisualArtwork: VisualArtwork \nThesis: Thesis \nPodcast: Podcast \nPodcastEpisode: 'Podcast Episode' \nPanorama: 'Panorama (http:\/\/ns.google.com\/photos\/1.0\/panorama)' \nPanoramaTour: 'Panorama Tour (http:\/\/ns.google.com\/photos\/1.0\/panorama)' \n3DModel: '3D Model' \nWebPage: 'Web Page' \nAudioObject: 'Audio Object' \nVideoObject: 'Video Object' \nConversation: 'Conversation (Oral History)' \nShortStory: 'Short Story' \n#} \n{% if data.type in ['DigitalDocument', 'Article','Thesis'] %} \n<i class=\"fas fa-file-alt fa-9x\"><\/i> \n{% elseif data.type in ['Photograph','Painting','VisualArtwork'] %} \n<i class=\"fas fa-photo-video fa-9x\"><\/i> \n{% elseif data.type in ['Movie','VideoObject'] %} \n<i class=\"fas fa-film fa-9x\"><\/i> \n{% elseif data.type in ['MusicRecording', 'AudioObject'] %} \n<i class=\"fas fa-headphones-alt fa-9x\"><\/i> \n{% elseif data.type in ['Podcast','PodcastEpisode'] %} \n<i class=\"fas fa-podcast\"><\/i> \n{% elseif data.type in ['ShortStory','Conversation',] %} \n<i class=\"fas fa-comments fa-9x\"><\/i> \n{% elseif data.type in ['Sculpture','3DModel'] %} \n<i class=\"fas fa-cubes fa-9x\"><\/i> \n{% elseif data.type in ['Book'] %} \n<i class=\"fas fa-book fa-9x\"><\/i> \n{% elseif data.type in ['WebPage'] %} \n<i class=\"fas fa-sitemap fa-9x\"><\/i> \n{% elseif data.type in ['Panorama','PanoramaTour'] %} \n<i class=\"fas fa-vr-cardboard fa-9x\"><\/i> \n{% elseif data.type in ['Dataset'] %} \n<i class=\"fas fa-table fa-9x\"><\/i> \n{% elseif data.type in ['CreativeWorkSeries'] %} \n<i class=\"fab fa-buffer fa-9x\"><\/i> \n{% elseif data.type in ['Collection'] %} \n<i class=\"fas fa-archive fa-9x\"><\/i> \n{% elseif data.type in ['Map'] %} \n<i class=\"fas fa-map-marked-alt fa-9x\"><\/i> \n{% else %} \n<i class=\"fas fa-file-contract fa-9x\"><\/i> \n{% endif %} \n{# -- ENDIF fontawesome -- #} \n{% endif %} \n<\/a> \n{% endapply %}","mimetype":"text\/html","name":"Multiple Thumbnails via IIIF and FontAwesome","langcode":"en"},"id":"7ca9ef30-1535-4616-b3b2-201dcc7d6a69"}}